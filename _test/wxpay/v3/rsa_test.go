package v3

import (
	v3 "sdk-weixin/wxpay/v3"
	"testing"
)

const priKey = `-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC++j0Bs8K3c7St
tO82KbTrrqwRklrQqKwLoXfHz3i+kGojhYMX5Yg4xzglLh/gg3mtb4Mdma5GT7N8
wMeQnPvFbHNGYcVvkNTNN0a98NI7S22fn1pXU4CieMvdWble/q0N9ATd5OflVyYv
7aUTmUgt/kGnknt+GPbVl56KRQOxJ7Hg6VV77MYykLVOGdehp3MvKEctrj6y9DuU
n2QtTVhG6qNMzGR+sQ0kx987VYjx3lcOJjybteHDbZk5MG0pn05Ckzkbi1PCBSqr
pWaYScDQP/srrR8abPEkDDi33H2dReqsTbQX64xkuJVvs7w/mdusOGciGkViXa3/
IjTJj1yNAgMBAAECggEAe4vtPZWqKP3sa9e6TOLMTQ/R9wgkQgpsSpXppFSeu0E3
uMUdmq794iVXOA5PxvGnHMEgJF0QNiJHbjRUpkQ4SG6xYF3N2S/rytqwpB4QExXn
1DTFv+qgM/tLf2YVGtRM5dLv9xCnyGEJrkXh3fzyifaLSLnltBy4SlNs1+xvyAFS
uGvBVX8oxM07JBsSWPEyuVcB9rA+Yll7HJxpqCuOcc+we3vOlGGo8twSmfbArc3f
wzMOcfOw0K4O+3Z6kQKgd2iF2E9xHpjyX35DQmq/QInjyQF3VZIHUGuwqxh7UZCJ
6fSMzaTDCWdyBpQ5LjF41NoVUNeR84jMZsDzeQ3nwQKBgQD6Ju7RidTia1OfV3YG
JfKu9AqCKiTiHpksAzYRdj8szlWgwOh1f+ayfwdw/dNikf27Tf3e8bw6nrh4nr5d
mPrqupnWDHB2g65C6caciCBdaMbpXieS1aRfZG5e/kRpkC2QC+Ggg8AcEtwvsDZp
oaOptwbiuSyS9+9wWskNhg7WfQKBgQDDcSrjfGsqn9DBZZ0xEsP9oerqEmUuNwTC
trZHIunsz4+duFwUn7x59U91uKkfUxpzWUx1R3fBW93t5EPt1sMdN25hgI3jfiZ/
Xew5yH0XYD6QVtWCXzXXuNkJOPM4zh+96MAinNZKXnEJTCvTvA7ZTCfTMLOqV5Mw
Tm9lh3irUQKBgAEx2GglyV9/dbnIGCc1XTBauAYhH2X5EXA1X7e7odeb8KrA4RtW
jgqCMs3mWHEbE2QmnjTHYMfC5EynLW+TAHfIhl2QV6UpQdbN+QXcXJM1oeWRbozz
+kH+X8ySWE9MwfrzI5O5rVw09to/dDMS844m8qB4k+7rwjf+JwGqhz2dAoGAKq5E
F3nMTXqpNBLkyRq4AmOh0YxC3FzXhU4xcEeHnleVnXPtZ/OaTWfs+mBhTp3vYNFX
iSUaWfed952p1/7WjULVsCVK1yttbNMuC1BlQP2brBnKdrYkJAASJZlyRC1/cRGr
I+PsSEFnnggsagjflUS0TcKM+d42Ho6CdUGocIECgYAGQxhXWFxNUVaC6zVmTtGT
+OMudpk/vozIVt/Tg6ZBOs4jMdsGWuJfDpBiqCEHglIwPraZe617R7aT/vsxmxAJ
BIFPlCVzoh99pGSnCDFxan2gjKYZ/pVOtdy6GkKGgygInLvfQ73ykD2E6hDMvBET
MlCkAH+u7DZXSFvUTFmKAA==
-----END PRIVATE KEY-----`

const pubkey = `-----BEGIN CERTIFICATE-----
MIID/DCCAuSgAwIBAgIUIcNt642Pl2e3qoTr28KCZYeYgSUwDQYJKoZIhvcNAQEL
BQAwXjELMAkGA1UEBhMCQ04xEzARBgNVBAoTClRlbnBheS5jb20xHTAbBgNVBAsT
FFRlbnBheS5jb20gQ0EgQ2VudGVyMRswGQYDVQQDExJUZW5wYXkuY29tIFJvb3Qg
Q0EwHhcNMjAwMzEyMDg0ODA5WhcNMjUwMzExMDg0ODA5WjCBjTETMBEGA1UEAwwK
MTUyNjgyNjY2MTEbMBkGA1UECgwS5b6u5L+h5ZWG5oi357O757ufMTkwNwYDVQQL
DDDkuIrmtbfkvJjmlrnkv6Hmga/np5HmioDmnI3liqHogqHku73mnInpmZDlhazl
j7gxCzAJBgNVBAYMAkNOMREwDwYDVQQHDAhTaGVuWmhlbjCCASIwDQYJKoZIhvcN
AQEBBQADggEPADCCAQoCggEBAL76PQGzwrdztK207zYptOuurBGSWtCorAuhd8fP
eL6QaiOFgxfliDjHOCUuH+CDea1vgx2ZrkZPs3zAx5Cc+8Vsc0ZhxW+Q1M03Rr3w
0jtLbZ+fWldTgKJ4y91ZuV7+rQ30BN3k5+VXJi/tpROZSC3+QaeSe34Y9tWXnopF
A7EnseDpVXvsxjKQtU4Z16Gncy8oRy2uPrL0O5SfZC1NWEbqo0zMZH6xDSTH3ztV
iPHeVw4mPJu14cNtmTkwbSmfTkKTORuLU8IFKqulZphJwNA/+yutHxps8SQMOLfc
fZ1F6qxNtBfrjGS4lW+zvD+Z26w4ZyIaRWJdrf8iNMmPXI0CAwEAAaOBgTB/MAkG
A1UdEwQCMAAwCwYDVR0PBAQDAgTwMGUGA1UdHwReMFwwWqBYoFaGVGh0dHA6Ly9l
dmNhLml0cnVzLmNvbS5jbi9wdWJsaWMvaXRydXNjcmw/Q0E9MUJENDIyMEU1MERC
QzA0QjA2QUQzOTc1NDk4NDZDMDFDM0U4RUJEMjANBgkqhkiG9w0BAQsFAAOCAQEA
RIHfKLu80piH0s7jbG5yXeYmZPI9yPYHJKbWBck++pjK2J5avymr5ldnMjXi2ofj
XKUBx0vHSKbIzzNwI2nv9/Pit+e+5xqmgKJP8i8JMvIZ7HBqWFtabZBgTJEYNPRH
SI1boptQ2wcjYf4CIky8sEQ1+uhfCdX28eB5xoevLsuoH73MqIzaRopcByNXXTh0
bPP+IU34qePO1fht1Be1wCIlcCVa26NEnhWYNZieeKX7/+DGZEPqZf29thoPmbco
ZvQKMNn/TL15l+EWPqPStuJ+IAofxKFw6nQ0g3Ki3QDjYmxT+ng3QTFy5JKsyXLb
BtTx/cm4T1+LV3LYjAtTpg==
-----END CERTIFICATE-----`

func TestRsaSignWithSha256(t *testing.T) {
	s := "待加密字符串"
	sign, err := v3.RsaSignWithSha256(s, priKey)
	if err != nil {
		t.Log(err)
	}
	t.Log("计算签名：" + sign)
	ok, err := v3.RsaVeryWithSha256(s, sign, pubkey)
	if err != nil {
		t.Error(err)
	}
	if ok {
		t.Log("RsaVeryWithSha256 success")
	} else {
		t.Log("RsaVeryWithSha256 fail")
	}
}
